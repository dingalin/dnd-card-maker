<section class="preview-panel">

    <!-- Fullscreen Button Removed -->

    <div class="canvas-container">
        <canvas id="card-canvas" width="600" height="840"></canvas>
        <canvas id="card-canvas-back" width="600" height="840" class="hidden"></canvas> <!-- Second Canvas -->

        <!-- Enhanced Loading Overlay with Progress Steps -->
        <div id="loading-overlay" class="hidden">
            <div class="loading-content">
                <!-- Progress Steps -->
                <div class="progress-steps">
                    <div class="step" data-step="1">
                        <div class="step-icon">💭</div>
                        <div class="step-label" data-i18n="preview.step1">רעיון</div>
                    </div>
                    <div class="step-connector"></div>
                    <div class="step" data-step="2">
                        <div class="step-icon">✍️</div>
                        <div class="step-label" data-i18n="preview.step2">תיאור</div>
                    </div>
                    <div class="step-connector"></div>
                    <div class="step" data-step="3">
                        <div class="step-icon">🎨</div>
                        <div class="step-label" data-i18n="preview.step3">ציור</div>
                    </div>
                    <div class="step-connector"></div>
                    <div class="step" data-step="4">
                        <div class="step-icon">✨</div>
                        <div class="step-label" data-i18n="preview.step4">סיום</div>
                    </div>
                </div>

                <!-- Progress Bar -->
                <div class="progress-bar-container">
                    <div id="progress-bar" class="progress-bar"></div>
                </div>

                <p id="loading-text" data-i18n="preview.loading">מתחיל...</p>
                <button id="cancel-btn" class="cancel-btn" data-i18n="preview.cancel">ביטול</button>
            </div>
        </div>
    </div>

    <!-- Flip Card Button - Below the card -->
    <div class="preview-controls">
        <button id="equip-item-btn" class="btn-primary" data-i18n-title="preview.equipCharacter" title="צייד דמות"
            style="background: linear-gradient(135deg, #e67e22, #d35400);">
            <span data-i18n="preview.equipCharacter">🗡️ צייד דמות</span>
        </button>
        <button id="split-view-btn" class="btn-secondary" data-i18n-title="preview.splitView" title="תצוגה מפוצלת">
            <span data-i18n="preview.splitView">📄|📄 פיצול</span>
        </button>
        <button id="flip-card-btn" class="card-viewer-btn card-viewer-btn-primary" data-i18n-title="preview.flipBack"
            title="הפוך קלף">
            <span data-i18n="preview.flipBack">↻ הצג אחורה</span>
        </button>
    </div>
</section>

<!-- Fullscreen Modal -->
<div id="fullscreen-modal" class="fullscreen-modal hidden">
    <button id="close-fullscreen-btn" class="close-fullscreen-btn">✕</button>
    <div class="fullscreen-canvas-container">
        <canvas id="fullscreen-canvas"></canvas>
    </div>
    <div class="zoom-controls">
        <button id="zoom-out-btn" class="zoom-btn">−</button>
        <span id="zoom-level">100%</span>
        <button id="zoom-in-btn" class="zoom-btn">+</button>
        <button id="zoom-reset-btn" class="zoom-btn">↻</button>
    </div>
</div>